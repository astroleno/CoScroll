# 配置系统使用指南

## 概述

CoScroll 现在使用配置化系统，让你可以轻松创建不同的音频体验，而无需修改核心代码。

## 配置文件结构

```typescript
interface ExperienceConfig {
  id: string              // 体验唯一标识
  title: string           // 显示标题
  description: string     // 描述信息

  audio: {
    file: string         // 音频文件路径
    loopEndTime: number  // 循环截止时间（秒）
    fadeOutDuration: number  // 渐弱时长（秒）
  }

  lyrics: {
    file: string         // LRC歌词文件路径
    encoding?: string    // 文件编码
  }

  visuals: {
    model?: string       // 3D模型路径（可选）
    fallbackColor: string // 球体颜色（模型加载失败时）
    rotationSpeed: number // 旋转速度倍数
  }

  interaction: {
    scrollSensitivity: number    // 滚动灵敏度
    speedRange: [number, number] // [最小速度, 最大速度]
  }
}
```

## 创建新体验

### 1. 准备资源文件

将以下文件放入 `public` 目录：
- 音频文件：`public/audio/your-audio.mp3`
- 歌词文件：`public/lyrics/your-lyrics.lrc`
- 3D模型（可选）：`public/models/your-model.glb`

### 2. 创建配置文件

```typescript
// config/my-experience.config.ts
import { ExperienceConfig } from '@/config/experience.config'

export const myExperienceConfig: ExperienceConfig = {
  id: 'my-experience',
  title: '我的体验',
  description: '自定义音频体验',

  audio: {
    file: '/audio/your-audio.mp3',
    loopEndTime: 120,    // 2分钟后循环
    fadeOutDuration: 3   // 3秒渐弱
  },

  lyrics: {
    file: '/lyrics/your-lyrics.lrc'
  },

  visuals: {
    fallbackColor: '#00ff00',  // 绿色球体
    rotationSpeed: 1.2
  },

  interaction: {
    scrollSensitivity: 0.02,
    speedRange: [0.2, 3.0]
  }
}
```

### 3. 使用配置

方法一：修改默认配置
```typescript
// config/experience.config.ts
import { myExperienceConfig } from './my-experience.config'

export const defaultConfig = myExperienceConfig
```

方法二：动态切换配置
```typescript
// 在组件中
const { config, updateConfig } = useExperienceConfig()

// 切换到新配置
updateConfig(myExperienceConfig)
```

## LRC 歌词格式

```
[00:12.50]第一句歌词
[00:17.20]第二句歌词
[00:21.10]第三句歌词
```

系统会自动：
- 解析时间戳
- 提取每句第一个汉字作为锚字
- 同步显示当前歌词

## 配置参数说明

### 音频参数

- `loopEndTime`: 循环截止时间，到达此时间点开始渐弱
- `fadeOutDuration`: 渐弱持续时间，渐弱完成后重新开始

### 交互参数

- `scrollSensitivity`: 滚动对播放速度的影响程度
- `speedRange`: 播放速度范围，`[0.2, 3.0]` 表示最慢0.2倍速，最快3倍速

### 视觉参数

- `fallbackColor`: 临时球体颜色（16进制格式）
- `rotationSpeed`: 旋转速度倍数，1.0为正常速度

## 示例配置

参考 `examples/custom-experience.config.ts` 查看完整示例。

## 最佳实践

1. **音频文件**: 使用 MP3 格式，建议码率 128kbps
2. **LRC文件**: 确保时间戳准确，歌词简洁
3. **循环时间**: 选择音乐自然停顿点作为循环截止时间
4. **配色方案**: 选择与内容氛围匹配的颜色
5. **交互设置**: 根据音频节奏调整滚动灵敏度

## 故障排除

1. **音频不播放**: 检查文件路径和格式
2. **歌词不同步**: 验证LRC时间戳格式
3. **配置不生效**: 确认配置文件导入正确
4. **颜色不显示**: 使用完整的16进制颜色码

这个配置系统让你可以轻松创建不同主题的沉浸式体验，而无需修改任何核心代码！