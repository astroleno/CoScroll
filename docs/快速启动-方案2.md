# 方案2快速启动指南

## 一键启动

```bash
cd /Users/aitoshuu/Documents/GitHub/CoScroll
npm run dev
```

访问显示的端口 (通常是 `http://localhost:3000` 或自动分配的端口)

## 预期效果

✅ **应该看到:**
- 彩色渐变背景
- 绿色发光的"空"字3D模型
- 缓慢旋转动画
- 呼吸式亮度变化
- 柔软的光晕边缘

⚠️ **如果只看到黑色模型:**
- 刷新浏览器 (Cmd+R / Ctrl+R)
- 检查控制台是否有错误
- 确认模型文件已加载

## 快速调整

### 1. 改变颜色 (`sketch.ts:155-157`)

```typescript
// 当前: 绿色
const r = 76 * breath;
const g = 230 * breath;
const b = 128 * breath;

// 改为紫色
const r = 200 * breath;
const g = 100 * breath;
const b = 255 * breath;

// 改为金色
const r = 255 * breath;
const g = 200 * breath;
const b = 50 * breath;
```

### 2. 调整旋转速度 (`sketch.ts:166`)

```typescript
// 当前: 2秒一圈
haloL0.rotateY(p.millis() / 2000.0);

// 更慢: 4秒一圈
haloL0.rotateY(p.millis() / 4000.0);

// 更快: 1秒一圈
haloL0.rotateY(p.millis() / 1000.0);

// 静止
// haloL0.rotateY(0);
```

### 3. 增强光晕效果 (`sketch.ts:195-201`)

```typescript
// 增加模糊层的透明度
p.tint(255, 255, 255, 120); // 从76改为120 (更亮)
p.image(haloL3, ...);

p.tint(255, 255, 255, 150); // 从102改为150
p.image(haloL2, ...);
```

### 4. 调整模型大小 (`sketch.ts:165`)

```typescript
haloL0.scale(2.0);  // 当前

// 更小
haloL0.scale(1.5);

// 更大
haloL0.scale(3.0);
```

## 常见问题

### Q: 页面空白

**检查:**
1. 打开浏览器控制台 (F12)
2. 查找错误信息
3. 确认看到 `[p5] Loading OBJ model: 001_空.obj`

**解决:**
```bash
# 清理缓存重启
rm -rf .next
npm run dev
```

### Q: 模型不旋转

**原因:** 可能JS暂停或帧率太低

**解决:**
- 检查控制台FPS: `setInterval(() => console.log('FPS:', frameRate()), 1000)`
- 简化效果 (减少模糊层)

### Q: 光晕不明显

**增强方案:**

1. **提高模糊强度** (`sketch.ts:174-178`)
   ```typescript
   applyBlur(haloL0, haloL1, 6.0); // 从4.0增加
   applyBlur(haloL1, haloL2, 9.0); // 从6.0增加
   applyBlur(haloL2, haloL3, 12.0); // 从8.0增加
   ```

2. **增加光晕透明度** (见上方"增强光晕效果")

3. **双重模糊** (`sketch.ts:47`)
   ```typescript
   const applyBlur = (source, target, sigma) => {
     target.image(source, ...);
     target.filter(p.BLUR, Math.floor(sigma));
     target.filter(p.BLUR, Math.floor(sigma)); // 再次应用
   };
   ```

### Q: 性能不佳 (< 30 FPS)

**优化方案:**

1. **降低FBO分辨率** (`sketch.ts:66-69`)
   ```typescript
   haloL0 = p.createGraphics(p.width*0.75, p.height*0.75, p.WEBGL);
   ```

2. **减少模糊层数**
   ```typescript
   // 只使用2层模糊
   applyBlur(haloL0, haloL1, 4.0);
   applyBlur(haloL1, haloL2, 6.0);
   // 注释掉 L3 的模糊和合成
   ```

3. **降低模糊强度**
   ```typescript
   applyBlur(haloL0, haloL1, 2.0); // 从4.0降低
   ```

## 文件结构

```
CoScroll/
├── src/p5/
│   └── sketch.ts           # 主要实现文件 ⭐
├── public/
│   └── models/10k_obj/
│       └── 001_空.obj      # 3D模型文件
└── docs/
    ├── 方案2-最终版本说明.md  # 技术文档
    ├── 参数调优指南.md         # 调参手册
    └── 故障排除-方案2.md      # 问题解决
```

## 核心代码位置

| 功能 | 文件位置 | 行号 |
|-----|---------|------|
| 模型渲染 | sketch.ts | 141-170 |
| 模糊处理 | sketch.ts | 172-178 |
| 合成效果 | sketch.ts | 180-207 |
| 颜色配置 | sketch.ts | 155-157 |
| 旋转速度 | sketch.ts | 166 |

## 下一步

### 增强效果

1. **多色渐变** - 渲染多层不同颜色
2. **噪声纹理** - 添加动态噪声
3. **交互控制** - 鼠标/键盘交互

### 性能优化

1. **自适应质量** - 根据FPS动态调整
2. **LOD系统** - 距离级别细节
3. **预加载** - 模型缓存

### 生产部署

1. **打包优化** - `npm run build`
2. **资源压缩** - 优化OBJ文件
3. **CDN部署** - 静态资源分发

---
**文档版本**: v1.0
**更新日期**: 2025-09-30
**测试状态**: ✅ 已验证

**需要帮助?** 查看 `docs/故障排除-方案2.md`